[2018-03-08 09:27:14,739] DEBUG [Controller id=1] Broker 2 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-03-08 09:50:00,494] ERROR [Controller id=1] Error while electing or becoming controller on broker 1 (kafka.controller.KafkaController)
org.I0Itec.zkclient.exception.ZkException: org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired
	at org.I0Itec.zkclient.exception.ZkException.create(ZkException.java:68)
	at kafka.utils.ZKCheckedEphemeral.create(ZkUtils.scala:1221)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1678)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1610)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
Caused by: org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:127)
	... 8 more
[2018-03-08 09:50:02,617] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2018-03-08 09:50:03,029] DEBUG [Controller id=1] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:03,031] DEBUG [Controller id=1] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:03,034] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-03-08 09:50:03,036] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:03,038] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2018-03-08 09:50:07,006] INFO [Controller id=1] 1 successfully elected as the controller (kafka.controller.KafkaController)
[2018-03-08 09:50:07,007] INFO [Controller id=1] Starting become controller state transition (kafka.controller.KafkaController)
[2018-03-08 09:50:07,739] INFO [Controller id=1] Initialized controller epoch to 61 and zk version 60 (kafka.controller.KafkaController)
[2018-03-08 09:50:08,658] INFO [Controller id=1] Incremented epoch to 62 (kafka.controller.KafkaController)
[2018-03-08 09:50:09,023] DEBUG [Controller id=1] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:11,361] DEBUG [Controller id=1] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:14,411] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-03-08 09:50:14,684] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2018-03-08 09:50:14,689] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2018-03-08 09:50:14,691] INFO [Controller-1-to-broker-1-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-03-08 09:50:14,691] INFO [Controller-1-to-broker-2-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-03-08 09:50:14,691] INFO [Controller-1-to-broker-0-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-03-08 09:50:14,863] INFO [Controller id=1] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-03-08 09:50:14,863] INFO [Controller id=1] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-03-08 09:50:14,864] INFO [Controller id=1] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-03-08 09:50:14,864] INFO [Controller id=1] Currently active brokers in the cluster: Set(0, 1, 2) (kafka.controller.KafkaController)
[2018-03-08 09:50:14,865] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-03-08 09:50:14,865] INFO [Controller id=1] Current list of topics in the cluster: Set(topic-commit, topiccommit, __consumer_offsets) (kafka.controller.KafkaController)
[2018-03-08 09:50:15,056] INFO [Controller id=1] List of topics to be deleted: topic-commit (kafka.controller.KafkaController)
[2018-03-08 09:50:15,057] INFO [Controller id=1] List of topics ineligible for deletion: topic-commit (kafka.controller.KafkaController)
[2018-03-08 09:50:16,054] INFO [Controller-1-to-broker-0-send-thread]: Controller 1 connected to bigData:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-03-08 09:50:16,054] INFO [Controller-1-to-broker-1-send-thread]: Controller 1 connected to bigData:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-03-08 09:50:16,054] INFO [Controller-1-to-broker-2-send-thread]: Controller 1 connected to bigData:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-03-08 09:50:18,315] INFO [ReplicaStateMachine controllerId=1] Invoking state change to OnlineReplica for replicas [Topic=topiccommit,Partition=2,Replica=1],[Topic=__consumer_offsets,Partition=25,Replica=0],[Topic=topiccommit,Partition=5,Replica=1],[Topic=topiccommit,Partition=8,Replica=0],[Topic=topiccommit,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=12,Replica=0],[Topic=topiccommit,Partition=1,Replica=1],[Topic=topiccommit,Partition=8,Replica=2],[Topic=topiccommit,Partition=1,Replica=0],[Topic=__consumer_offsets,Partition=31,Replica=0],[Topic=__consumer_offsets,Partition=40,Replica=0],[Topic=topiccommit,Partition=7,Replica=0],[Topic=__consumer_offsets,Partition=35,Replica=0],[Topic=topiccommit,Partition=3,Replica=0],[Topic=__consumer_offsets,Partition=9,Replica=0],[Topic=__consumer_offsets,Partition=43,Replica=0],[Topic=topiccommit,Partition=1,Replica=2],[Topic=__consumer_offsets,Partition=2,Replica=0],[Topic=topiccommit,Partition=5,Replica=0],[Topic=__consumer_offsets,Partition=11,Replica=0],[Topic=__consumer_offsets,Partition=29,Replica=0],[Topic=__consumer_offsets,Partition=30,Replica=0],[Topic=topiccommit,Partition=9,Replica=2],[Topic=__consumer_offsets,Partition=4,Replica=0],[Topic=topiccommit,Partition=4,Replica=1],[Topic=__consumer_offsets,Partition=42,Replica=0],[Topic=topiccommit,Partition=9,Replica=1],[Topic=__consumer_offsets,Partition=26,Replica=0],[Topic=__consumer_offsets,Partition=34,Replica=0],[Topic=__consumer_offsets,Partition=17,Replica=0],[Topic=topiccommit,Partition=8,Replica=1],[Topic=__consumer_offsets,Partition=37,Replica=0],[Topic=__consumer_offsets,Partition=27,Replica=0],[Topic=__consumer_offsets,Partition=10,Replica=0],[Topic=topiccommit,Partition=0,Replica=1],[Topic=__consumer_offsets,Partition=41,Replica=0],[Topic=__consumer_offsets,Partition=20,Replica=0],[Topic=__consumer_offsets,Partition=28,Replica=0],[Topic=topiccommit,Partition=0,Replica=0],[Topic=__consumer_offsets,Partition=46,Replica=0],[Topic=topiccommit,Partition=7,Replica=2],[Topic=__consumer_offsets,Partition=39,Replica=0],[Topic=__consumer_offsets,Partition=47,Replica=0],[Topic=__consumer_offsets,Partition=49,Replica=0],[Topic=__consumer_offsets,Partition=22,Replica=0],[Topic=topiccommit,Partition=3,Replica=2],[Topic=topiccommit,Partition=4,Replica=2],[Topic=topiccommit,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=1,Replica=0],[Topic=__consumer_offsets,Partition=24,Replica=0],[Topic=__consumer_offsets,Partition=6,Replica=0],[Topic=topiccommit,Partition=7,Replica=1],[Topic=topiccommit,Partition=9,Replica=0],[Topic=__consumer_offsets,Partition=36,Replica=0],[Topic=topiccommit,Partition=2,Replica=0],[Topic=__consumer_offsets,Partition=8,Replica=0],[Topic=__consumer_offsets,Partition=38,Replica=0],[Topic=__consumer_offsets,Partition=16,Replica=0],[Topic=topiccommit,Partition=5,Replica=2],[Topic=__consumer_offsets,Partition=21,Replica=0],[Topic=topiccommit,Partition=6,Replica=2],[Topic=topiccommit,Partition=4,Replica=0],[Topic=__consumer_offsets,Partition=18,Replica=0],[Topic=__consumer_offsets,Partition=0,Replica=0],[Topic=__consumer_offsets,Partition=48,Replica=0],[Topic=__consumer_offsets,Partition=5,Replica=0],[Topic=topiccommit,Partition=6,Replica=0],[Topic=__consumer_offsets,Partition=13,Replica=0],[Topic=__consumer_offsets,Partition=3,Replica=0],[Topic=__consumer_offsets,Partition=44,Replica=0],[Topic=__consumer_offsets,Partition=15,Replica=0],[Topic=__consumer_offsets,Partition=7,Replica=0],[Topic=topiccommit,Partition=3,Replica=1],[Topic=__consumer_offsets,Partition=19,Replica=0],[Topic=__consumer_offsets,Partition=33,Replica=0],[Topic=topiccommit,Partition=6,Replica=1],[Topic=__consumer_offsets,Partition=45,Replica=0],[Topic=__consumer_offsets,Partition=23,Replica=0],[Topic=__consumer_offsets,Partition=32,Replica=0],[Topic=__consumer_offsets,Partition=14,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:18,366] INFO [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map([Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=2,Replica=2] -> OnlineReplica, [Topic=topiccommit,Partition=3,Replica=1] -> OnlineReplica, [Topic=topiccommit,Partition=7,Replica=2] -> OnlineReplica, [Topic=topiccommit,Partition=8,Replica=1] -> OnlineReplica, [Topic=topiccommit,Partition=0,Replica=1] -> OnlineReplica, [Topic=topiccommit,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=9,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=5,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=7,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=6,Replica=2] -> OnlineReplica, [Topic=topic-commit,Partition=0,Replica=11] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=8,Replica=2] -> OnlineReplica, [Topic=topiccommit,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=3,Replica=2] -> OnlineReplica, [Topic=topiccommit,Partition=9,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=4,Replica=2] -> OnlineReplica, [Topic=topiccommit,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=6,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=4,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=topiccommit,Partition=5,Replica=1] -> OnlineReplica, [Topic=topiccommit,Partition=4,Replica=0] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:18,403] INFO [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map(__consumer_offsets-19 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, topic-commit-0 -> OfflinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, topiccommit-3 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, topiccommit-7 -> OnlinePartition, topiccommit-5 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-13 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, topiccommit-0 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, topiccommit-9 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, topiccommit-1 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, topiccommit-8 -> OnlinePartition, topiccommit-6 -> OnlinePartition, topiccommit-2 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, topiccommit-4 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2018-03-08 09:50:18,583] INFO [Controller id=1] Ready to serve as the new controller with epoch 62 (kafka.controller.KafkaController)
[2018-03-08 09:50:18,583] INFO [Topic Deletion Manager 1], Handling deletion for topics topic-commit (kafka.controller.TopicDeletionManager)
[2018-03-08 09:50:18,585] DEBUG [ReplicaStateMachine controllerId=1] Are all replicas for topic topic-commit deleted Map([Topic=topic-commit,Partition=0,Replica=11] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:18,586] INFO [Topic Deletion Manager 1], Retrying delete topic for topic topic-commit since replicas [Topic=topic-commit,Partition=0,Replica=11] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2018-03-08 09:50:18,586] INFO [ReplicaStateMachine controllerId=1] Invoking state change to OfflineReplica for replicas [Topic=topic-commit,Partition=0,Replica=11] (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:19,230] DEBUG [Controller id=1] Removing replica 11 from ISR 11 for partition topic-commit-0. (kafka.controller.KafkaController)
[2018-03-08 09:50:19,758] INFO [Controller id=1] Retaining last ISR 11 of partition topic-commit-0 since unclean leader election is disabled (kafka.controller.KafkaController)
[2018-03-08 09:50:20,075] INFO [Controller id=1] New leader and ISR for partition topic-commit-0 is {"leader":-1,"leader_epoch":34,"isr":[11]} (kafka.controller.KafkaController)
[2018-03-08 09:50:20,082] DEBUG The stop replica request (delete = true) sent to broker 11 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-03-08 09:50:20,083] DEBUG The stop replica request (delete = false) sent to broker 11 is [Topic=topic-commit,Partition=0,Replica=11] (kafka.controller.ControllerBrokerRequestBatch)
[2018-03-08 09:50:20,087] WARN [Channel manager on controller 1]: Not sending request (type=StopReplicaRequest, controllerId=1, controllerEpoch=62, deletePartitions=false, partitions=topic-commit-0) to broker 11, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-03-08 09:50:20,089] INFO [Topic Deletion Manager 1], Not retrying deletion of topic topic-commit at this time since it is marked ineligible for deletion (kafka.controller.TopicDeletionManager)
[2018-03-08 09:50:20,181] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-03-08 09:50:20,364] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-03-08 09:50:20,364] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-03-08 09:50:20,364] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-03-08 09:50:20,364] INFO [Controller id=1] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-03-08 09:50:20,364] INFO [PartitionStateMachine controllerId=1] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-03-08 09:50:20,859] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-03-08 09:50:20,864] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2018-03-08 09:50:20,864] DEBUG [Controller id=1] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:20,864] DEBUG [Controller id=1] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-03-08 09:50:20,864] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-03-08 09:50:20,864] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-03-08 09:50:20,865] INFO [Controller-1-to-broker-2-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-03-08 09:50:20,865] INFO [Controller-1-to-broker-2-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-03-08 09:50:20,865] INFO [Controller-1-to-broker-2-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-03-08 09:50:20,866] INFO [Controller-1-to-broker-1-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,361] WARN [Controller-1-to-broker-1-send-thread]: Controller 1 epoch 62 fails to send request (type: UpdateMetadataRequest=, controllerId=1, controllerEpoch=62, partitionStates={__consumer_offsets-22=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0], offlineReplicas=[]), __consumer_offsets-30=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-8=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-21=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-4=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-27=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-7=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-9=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-46=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-25=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-35=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), topiccommit-4=PartitionState(controllerEpoch=59, leader=1, leaderEpoch=34, isr=[1, 2], zkVersion=76, replicas=[2, 1, 0], offlineReplicas=[]), __consumer_offsets-41=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-33=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-23=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-49=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-47=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-16=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-9=PartitionState(controllerEpoch=61, leader=2, leaderEpoch=39, isr=[2, 0], zkVersion=77, replicas=[1, 0, 2], offlineReplicas=[]), __consumer_offsets-28=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-3=PartitionState(controllerEpoch=61, leader=2, leaderEpoch=41, isr=[2, 0], zkVersion=78, replicas=[1, 0, 2], offlineReplicas=[]), __consumer_offsets-31=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-36=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-42=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-3=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-18=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-37=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-15=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-24=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-8=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=34, isr=[0, 1, 2], zkVersion=74, replicas=[0, 1, 2], offlineReplicas=[]), __consumer_offsets-38=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-17=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-48=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-2=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=34, isr=[0, 2, 1], zkVersion=75, replicas=[0, 1, 2], offlineReplicas=[]), __consumer_offsets-19=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-11=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-13=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-2=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-43=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-6=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-14=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-20=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-0=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-44=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-7=PartitionState(controllerEpoch=61, leader=2, leaderEpoch=36, isr=[0, 1, 2], zkVersion=79, replicas=[2, 0, 1], offlineReplicas=[]), __consumer_offsets-39=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), topiccommit-6=PartitionState(controllerEpoch=61, leader=2, leaderEpoch=41, isr=[2, 0], zkVersion=81, replicas=[1, 2, 0], offlineReplicas=[]), __consumer_offsets-12=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-45=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-1=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-5=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0], offlineReplicas=[]), __consumer_offsets-26=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), topic-commit-0=PartitionState(controllerEpoch=61, leader=-2, leaderEpoch=0, isr=[11], zkVersion=0, replicas=[11], offlineReplicas=[11]), __consumer_offsets-29=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-34=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), __consumer_offsets-10=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-32=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0], offlineReplicas=[]), __consumer_offsets-40=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0], offlineReplicas=[]), topiccommit-5=PartitionState(controllerEpoch=61, leader=0, leaderEpoch=34, isr=[0, 1, 2], zkVersion=78, replicas=[0, 2, 1], offlineReplicas=[]), topiccommit-1=PartitionState(controllerEpoch=59, leader=0, leaderEpoch=34, isr=[0, 1, 2], zkVersion=77, replicas=[2, 0, 1], offlineReplicas=[]), topiccommit-0=PartitionState(controllerEpoch=61, leader=2, leaderEpoch=39, isr=[2, 0], zkVersion=77, replicas=[1, 2, 0], offlineReplicas=[])}, liveBrokers=(id=0, endPoints=(host=bigData, port=9092, listenerName=ListenerName(PLAINTEXT), securityProtocol=PLAINTEXT), rack=null), (id=1, endPoints=(host=bigData, port=9093, listenerName=ListenerName(PLAINTEXT), securityProtocol=PLAINTEXT), rack=null), (id=2, endPoints=(host=bigData, port=9094, listenerName=ListenerName(PLAINTEXT), securityProtocol=PLAINTEXT), rack=null)) to broker bigData:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:95)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:230)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-03-08 09:50:23,365] INFO [Controller-1-to-broker-1-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,365] INFO [Controller-1-to-broker-1-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,367] INFO [Controller-1-to-broker-0-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,367] INFO [Controller-1-to-broker-0-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,367] INFO [Controller-1-to-broker-0-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-03-08 09:50:23,370] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2018-03-08 09:50:24,239] DEBUG [Controller id=1] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-03-08 09:50:25,367] DEBUG [Controller id=1] Sending MetadataRequest to Brokers:Vector() for TopicAndPartitions:Set(topiccommit-2, topiccommit-6, topiccommit-5, topiccommit-9, topiccommit-0, topiccommit-4, topiccommit-8, topiccommit-3) (kafka.controller.KafkaController)
[2018-03-08 09:50:26,628] ERROR [controller-event-thread]: Error processing event IsrChangeNotification(Buffer(isr_change_0000000057, isr_change_0000000055, isr_change_0000000056, isr_change_0000000054)) (kafka.controller.ControllerEventManager$ControllerEventThread)
java.util.NoSuchElementException: key not found: topiccommit-2
	at scala.collection.MapLike.default(MapLike.scala:232)
	at scala.collection.MapLike.default$(MapLike.scala:231)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.ControllerBrokerRequestBatch.updateMetadataRequestPartitionInfo$1(ControllerChannelManager.scala:358)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7(ControllerChannelManager.scala:393)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7$adapted(ControllerChannelManager.scala:393)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:320)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:976)
	at kafka.controller.ControllerBrokerRequestBatch.addUpdateMetadataRequestForBrokers(ControllerChannelManager.scala:393)
	at kafka.controller.KafkaController.sendUpdateMetadataRequest(KafkaController.scala:1039)
	at kafka.controller.KafkaController$IsrChangeNotification.processUpdateNotifications(KafkaController.scala:1386)
	at kafka.controller.KafkaController$IsrChangeNotification.process(KafkaController.scala:1375)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-03-08 09:50:26,637] DEBUG [Controller id=1] Sending MetadataRequest to Brokers:Vector() for TopicAndPartitions:Set(topiccommit-4) (kafka.controller.KafkaController)
[2018-03-08 09:50:28,231] ERROR [controller-event-thread]: Error processing event IsrChangeNotification(Buffer(isr_change_0000000057, isr_change_0000000058, isr_change_0000000055, isr_change_0000000056, isr_change_0000000054)) (kafka.controller.ControllerEventManager$ControllerEventThread)
java.util.NoSuchElementException: key not found: topiccommit-4
	at scala.collection.MapLike.default(MapLike.scala:232)
	at scala.collection.MapLike.default$(MapLike.scala:231)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.ControllerBrokerRequestBatch.updateMetadataRequestPartitionInfo$1(ControllerChannelManager.scala:358)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7(ControllerChannelManager.scala:393)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7$adapted(ControllerChannelManager.scala:393)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:95)
	at kafka.controller.ControllerBrokerRequestBatch.addUpdateMetadataRequestForBrokers(ControllerChannelManager.scala:393)
	at kafka.controller.KafkaController.sendUpdateMetadataRequest(KafkaController.scala:1039)
	at kafka.controller.KafkaController$IsrChangeNotification.processUpdateNotifications(KafkaController.scala:1386)
	at kafka.controller.KafkaController$IsrChangeNotification.process(KafkaController.scala:1375)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-03-08 09:50:28,235] DEBUG [Controller id=1] Sending MetadataRequest to Brokers:Vector() for TopicAndPartitions:Set(topiccommit-2, topiccommit-7, topiccommit-1, topiccommit-5, topiccommit-8) (kafka.controller.KafkaController)
[2018-03-08 09:50:30,320] ERROR [controller-event-thread]: Error processing event IsrChangeNotification(Buffer(isr_change_0000000057, isr_change_0000000058, isr_change_0000000055, isr_change_0000000056, isr_change_0000000054, isr_change_0000000059)) (kafka.controller.ControllerEventManager$ControllerEventThread)
java.util.NoSuchElementException: key not found: topiccommit-2
	at scala.collection.MapLike.default(MapLike.scala:232)
	at scala.collection.MapLike.default$(MapLike.scala:231)
	at scala.collection.AbstractMap.default(Map.scala:59)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:65)
	at kafka.controller.ControllerBrokerRequestBatch.updateMetadataRequestPartitionInfo$1(ControllerChannelManager.scala:358)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7(ControllerChannelManager.scala:393)
	at kafka.controller.ControllerBrokerRequestBatch.$anonfun$addUpdateMetadataRequestForBrokers$7$adapted(ControllerChannelManager.scala:393)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:320)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:976)
	at kafka.controller.ControllerBrokerRequestBatch.addUpdateMetadataRequestForBrokers(ControllerChannelManager.scala:393)
	at kafka.controller.KafkaController.sendUpdateMetadataRequest(KafkaController.scala:1039)
	at kafka.controller.KafkaController$IsrChangeNotification.processUpdateNotifications(KafkaController.scala:1386)
	at kafka.controller.KafkaController$IsrChangeNotification.process(KafkaController.scala:1375)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:53)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:53)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
